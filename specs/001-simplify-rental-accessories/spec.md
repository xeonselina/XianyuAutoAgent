# Feature Specification: 简化租赁附件选择

**Feature Branch**: `001-simplify-rental-accessories`  
**Created**: 2026-01-04  
**Status**: Draft  
**Input**: User description: "简化租赁时的附件功能.租设备时附件有 4 种: 手柄,镜头支架,手机支架, 三脚架.以前手柄,镜头支架并没有和手机 1:1配齐. 现在手柄和镜头支架已经是 1:1 配齐了,所以这两种附件在页面上不再需要选具体是哪个手柄哪个镜头支架了. 设备附件的选择只留下手机支架就好了.镜头支架和手柄变成是添加和编辑租赁时的两个复选框. 但是注意不要影响到面单和发货单的打印,不要影响到甘特图上要寄出附件的显示"

## User Scenarios & Testing *(mandatory)*

### User Story 1 - 创建租赁订单时选择附件 (Priority: P1)

当工作人员创建或编辑租赁订单时,需要快速指定设备附带的附件。由于手柄和镜头支架现已与每台设备1:1配齐,工作人员无需再逐个选择具体的手柄或镜头支架编号,只需通过简单的复选框指示是否随设备一起出租即可。对于手机支架和三脚架,由于库存数量有限且未与设备配齐,仍需从可用库存中选择具体的附件。

**Why this priority**: 这是核心业务流程,简化后能够显著提升订单创建效率,减少操作步骤和出错可能。

**Independent Test**: 可通过创建一个完整的租赁订单并验证附件选择界面的变化来独立测试,确认手柄和镜头支架显示为复选框,手机支架保持下拉选择。

**Acceptance Scenarios**:

1. **Given** 工作人员正在创建新的租赁订单, **When** 进入附件选择界面, **Then** 应该看到"手柄"和"镜头支架"以复选框形式呈现,手机支架以下拉选择方式呈现(显示可用库存)
2. **Given** 工作人员勾选了"手柄"和"镜头支架"复选框, **When** 保存订单, **Then** 系统应记录该设备配套的手柄和镜头支架将随订单一起出租
3. **Given** 工作人员正在编辑现有租赁订单, **When** 修改附件选择, **Then** 应能够通过复选框勾选/取消手柄和镜头支架,通过下拉框更换手机支架选择

---

### User Story 2 - 打印面单和发货单 (Priority: P1)

仓库人员在准备发货时需要打印面单和发货单,这些单据必须清晰列出需要随设备一起寄出的所有附件,包括手柄、镜头支架、手机支架等,以便准确拣货和打包。

**Why this priority**: 这是物流操作的关键环节,单据信息准确性直接影响发货准确率和客户满意度。即使简化了前端选择方式,后端打印功能必须保持完整。

**Independent Test**: 可通过创建包含各种附件组合的订单,然后打印面单和发货单来验证所有附件信息都正确显示。

**Acceptance Scenarios**:

1. **Given** 订单包含手柄、镜头支架和手机支架, **When** 打印面单, **Then** 面单上应清晰列出所有三种附件
2. **Given** 订单只勾选了手柄复选框,未选择其他附件, **When** 打印发货单, **Then** 发货单上应只显示手柄
3. **Given** 订单附件选择为空, **When** 打印面单/发货单, **Then** 单据上应明确标注"无附件"或不显示附件部分

---

### User Story 3 - 甘特图显示附件信息 (Priority: P2)

管理人员使用甘特图查看设备租赁时间线和物流状态时,需要看到每个订单计划寄出的附件信息,以便协调库存和物流安排。

**Why this priority**: 这是管理层面的可视化需求,对日常操作影响较小但对资源规划很重要。

**Independent Test**: 可通过在甘特图中查看包含不同附件组合的订单,验证附件信息是否正确显示。

**Acceptance Scenarios**:

1. **Given** 甘特图显示多个租赁订单, **When** 查看订单详情或工具提示, **Then** 应显示该订单包含的所有附件(手柄、镜头支架、手机支架、三脚架)
2. **Given** 订单附件信息已更新, **When** 刷新甘特图, **Then** 应反映最新的附件配置
3. **Given** 多个订单在同一时间段需要相同附件, **When** 查看甘特图, **Then** 管理人员能够识别潜在的附件库存冲突

---

### Edge Cases

- 当用户勾选了"手柄"复选框后又取消勾选,现有订单中已关联的手柄信息如何处理?
- 如果设备在租赁期间,管理员修改了附件配置(例如取消手柄),已打印的面单和实际寄出附件不一致时如何追溯?
- 当系统从旧的附件选择方式迁移到新方式时,历史订单中已选择的具体手柄/镜头支架编号如何在新界面中显示?
- 如果某些设备例外没有配齐手柄或镜头支架,复选框模式是否仍适用?

## Requirements *(mandatory)*

### Functional Requirements

- **FR-001**: 系统必须在租赁订单的附件选择界面将"手柄"和"镜头支架"显示为复选框(勾选/不勾选)
- **FR-002**: 系统必须保留"手机支架"和"三脚架"的下拉选择方式,允许用户从可用库存中选择具体附件
- **FR-003**: 用户必须能够在创建新租赁订单时通过勾选复选框指定是否包含手柄和镜头支架
- **FR-004**: 用户必须能够在编辑现有租赁订单时修改手柄和镜头支架的复选框状态
- **FR-005**: 系统必须在保存订单时记录手柄和镜头支架的选择状态(包含/不包含)
- **FR-006**: 系统必须在打印面单时显示订单包含的所有附件(手柄、镜头支架、手机支架、三脚架)
- **FR-007**: 系统必须在打印发货单时显示订单包含的所有附件(手柄、镜头支架、手机支架、三脚架)
- **FR-008**: 系统必须在甘特图的订单信息中显示该订单计划寄出的所有附件
- **FR-009**: 系统必须保持面单、发货单和甘特图中附件信息的一致性
- **FR-010**: 系统必须支持历史订单数据的兼容显示,历史订单中的手柄和镜头支架在新界面只显示复选框勾选状态,不显示具体编号

### Key Entities

- **租赁订单(Rental Order)**: 包含设备信息、租赁时间、客户信息和附件配置
- **附件(Accessory)**: 分为两类
  - 配套附件:手柄和镜头支架(与设备1:1配齐,以布尔值记录是否随订单出租)
  - 库存附件:手机支架和三脚架(需从有限库存中选择具体物品)
- **面单(Shipping Label)**: 包含订单基本信息和需寄出的附件清单
- **发货单(Packing List)**: 用于仓库拣货,列出订单中所有需要打包的物品
- **甘特图项(Gantt Chart Item)**: 可视化展示订单时间线和相关资源(含附件)

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: 工作人员创建或编辑包含手柄和镜头支架的租赁订单时,操作步骤减少至少50%(从需要逐个选择具体附件缩减为勾选复选框)
- **SC-002**: 100%的面单和发货单正确显示订单包含的所有附件信息,包括通过复选框选择的手柄和镜头支架
- **SC-003**: 甘特图中100%的订单能够准确显示附件配置信息
- **SC-004**: 附件选择相关的用户操作错误率降低至少30%(因简化选择流程)
- **SC-005**: 系统能够在1秒内完成附件选择界面的渲染和交互响应
