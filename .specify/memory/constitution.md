# XianyuAutoAgent 项目宪法
<!-- 定义项目的核心原则和开发规范 -->

## 核心原则

### I. API 优先
所有功能首先设计为 API 接口；API 必须独立可测试、文档完整；明确的用途要求 - 避免仅为组织而存在的接口

### II. 内网部署
所有服务面向内网部署；不需要复杂的鉴权机制；优先考虑简单性和可维护性

### III. 测试优先 (不可协商)
TDD 强制执行: 测试编写 → 用户确认 → 测试失败 → 然后实现；严格执行红-绿-重构循环

### IV. 集成测试
需要集成测试的重点领域: 新 API 契约测试、契约变更、服务间通信、共享数据模型

### V. 可观测性
结构化日志必需 (JSON 格式)；所有关键操作必须记录审计日志；日志包含必要的上下文信息 (session_id, event_type, duration 等)

### VI. 简单性
从简单开始，遵循 YAGNI 原则；避免过度设计；复杂性必须有充分理由

## 技术约束

### 语言和框架
- **Python**: 3.11+ 作为主要开发语言
- **Web 框架**: FastAPI 用于 HTTP 服务
- **AI 模型**: ali qwen
- **数据存储**: Redis (非持久化) + ChromaDB (持久化)

### 性能标准
- API 响应时间: P95 < 2s
- 并发支持: 最少 100 req/s
- 知识库检索: < 100ms

### 部署要求
- 内网部署，无需外网访问
- 无需鉴权机制
- 支持单进程和多进程部署

## 开发工作流

### 代码审查
- 所有代码变更必须经过审查
- 验证是否符合本宪法要求
- 复杂度必须有充分理由

### 质量门控
- 单元测试必须通过
- 集成测试必须通过
- 代码符合项目规范

### 文档要求
- API 变更必须更新 OpenAPI 规范
- 数据模型变更必须更新 data-model.md
- 重大变更必须更新 README

## 治理规则

1. **宪法优先级**: 本宪法优先于所有其他实践
2. **修正流程**: 修改需要文档说明、批准和迁移计划
3. **合规性**: 所有 PR/审查必须验证合规性
4. **复杂性**: 增加的复杂性必须有充分理由
5. **运行时指导**: 开发过程中遵循项目规范和最佳实践

**版本**: 1.0.0 | **批准日期**: 2025-12-22 | **最后修订**: 2025-12-22
