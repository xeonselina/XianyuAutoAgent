**对接流程图：**

![](https://kuaimai-public.oss-cn-shanghai.aliyuncs.com/public/document/image20240222.png)

**请求结构**

协议：http或https

域名：cloud.kuaimai.com

请求方式：POST

请求头：Content-Type:application/json

响应：json

**一、公共参数**  
**1.公共请求参数**

| 参数名    | 含义     | 类型   | 必传 | 示例                               |
| --------- | -------- | ------ | ---- | ---------------------------------- |
| appId     | 应用ID   | String | 是   | "1100"                             |
| timestamp | 当前时间 | String | 是   | "2020-08-14 15:29:29"              |
| sign      | 签名值   | String | 是   | "ff9d58e9abcf50dcc423fad782636c21" |

**2.公共响应参数**

| 参数名  | 含义     | 类型    | 必传 | 说明                      |
| ------- | -------- | ------- | ---- | ------------------------- |
| status  | 响应结果 | boolean | 是   | true为成功，false为失败   |
| data    | 响应数据 | object  | 否   | 具体接口的返回数据        |
| message | 响应说明 | String  | 否   | status为false时，返回信息 |
| code    | code码   | Number  | 否   | 详情见最下方code码说明    |

**二、签名规则 （可通过官网调试工具中的查看签名进行调试）**  
将所有参数（sign除外，包含公共请求参数和私有请求参数，并且剔除value为空的参数），对参数的key进行ascii码升序排序，并组成如下字符串

```java
x={appId}{appId_val}{param1}{param1_val}{param2}{param2_val}{timestamp}{timestamp_val}...
```

将appSecret（接入方在快麦云的密钥）在上面的排序好的字符串前后都追加上，然后md5加密, md5之后的值取32位小写

```java
sign=MD5({secret}x{secret})
```

备注：appId和secret可通过页面右上角 注册\\登录 按钮，登录注册后台在系统集成菜单页面获取；签名规则中的{ } 为占位符,其本身不参与字符串的拼接。

sign值获取举例说明：

**公共请求参数**

| 参数名    | 含义     | 类型   | 示例值                             |
| --------- | -------- | ------ | ---------------------------------- |
| appId     | 应用ID   | String | "123456"                           |
| timestamp | 当前时间 | String | "2020-10-10 15:29:29"              |
| sign      | 签名值   | String | "9b7af7899fd1f7e1feebe8f4a0d4e15f" |

**私有请求参数：**

| **参数名** | **含义**   | **类型**   | **示例值**    |
| ---------- | ---------- | ---------- | ------------- |
| **sn**     | **序列号** | **String** | **"KM118MW"** |

上面的参与签名的公共参数为：appId , timestamp ; 私有参数为：sn

1.  第一步升序排序拼接：appId123456snKM118MWtimestamp2020-10-10 15:29:29
2.  第二步前后拼接appSecret,这里假定你的secret是abc：abcappId123456snKM118MWtimestamp2020-10-10 15:29:29abc
3.  第三步对上面的字符串进行md5加密取32位小写：sign=MD5(abcappId123456snKM118MWtimestamp2020-10-10 15:29:29abc)

JAVA签名示例代码：

```java
public static String createSign(Map<String,Object> paramMap, String secret) {
    // 第一步：检查参数是否已经排序
    String[] keys = paramMap.keySet().toArray(new String[0]);
    Arrays.sort(keys);
    // 第二步：把所有参数名和参数值串在一起
    StringBuilder query = new StringBuilder();
    query.append(secret);
    for (String key : keys) {
        if (key != null && paramMap.get(key) != null) {
            String keyString = "" + key;
            String valueString = "" + paramMap.get(key);
            if (StringUtils.isNotBlank(keyString) && StringUtils.isNotBlank(valueString)) {
                query.append(keyString).append(valueString);
            }
        }
    }
    query.append(secret);
    String sign;
    // 第三步：使用MD5加密,取32位小写
    return DigestUtil.md5Hex(query.toString());
}
```

JS/uni-app/微信小程序签名示例代码：

```js
import md5 from "md5";

function signStr({ obj, secret }) {
  let filteredObj = Object.entries(obj)
    .filter(([key, value]) => value || value === 0 || value === false)
    .reduce((acc, [key, value]) => {
      acc[key] = value;
      return acc;
    }, {});

  let keysSorted = Object.keys(filteredObj).sort();

  let str = keysSorted.map((key) => key + filteredObj[key]).join("");

  return md5(secret + str + secret);
}
```

**API列表**

| **api**           | **描述**                                                                                |
| ----------------- | --------------------------------------------------------------------------------------- |
| bindDevice        | 绑定设备 适用机型：所有机型                                                             |
| unbindDevice      | 解绑设备 适用机型：所有机型                                                             |
| tsplTemplatePrint | 标签模板打印-间隙纸 适用机型:KM118系列,KME31系列,KME41系列，KME20系列，KMSX320,KMUL410  |
| tsplTemplateWrite | 小票模板打印-间隙纸 适用机型:KM118系列,KME31系列,KME41系列，KME20系列，KMSX320,KMUL410  |
| escTemplatePrint  | 小票模板打印-连续纸 适用机型:KM118系列,KME31系列,KME41系列，KME20系列，KMDP系列         |
| tsplXmlWrite      | 自定义xml打印-间隙纸 适用机型:KM118系列,KME31系列,KME41系列，KME20系列，KMSX320,KMUL410 |
| escXmlWrite       | 自定义xml打印-连续纸 适用机型:KM118系列,KME31系列,KME41系列，KME20系列，KMDP系列        |
| deviceWrite       | TSPL/ESC指令打印 适用机型:KM118系列,KME31系列,KME41系列，KME20系列                      |
| escWrite          | ESC指令打印 适用机型:KMDP系列,KMUP380C                                                  |
| shareFilePrint    | 共享云打印 适用机型：电脑安装番茄打印管家并开通共享打印USB连接的机器                    |
| result            | 打印任务结果查询 适用机型：KM118系列,KME31系列,KME41系列，KME20系列                     |
| batchStatus       | 打印机状态查询 适用机型：所有机型                                                       |
| broadcast         | 语言播报 适用机型: KM118MGL,KME31GP                                                     |

说明：

1.  打印小票，常用实现接口为：escTemplatePrint 和 escXmlWrite
2.  打印标签或者面单，常用实现接口为：tsplTemplatePrint 和 tsplXmlWrite
3.  单设备打印，以设备为维度接口最大的QPS为6

**三、具体接口**

#### 1.绑定打印机

**url:**/api/cloud/device/bindDevice  
**公共请求参数**

| 参数名    | 含义     | 类型   | 必传 | 示例                               |
| --------- | -------- | ------ | ---- | ---------------------------------- |
| appId     | 应用ID   | String | 是   | "1100"                             |
| timestamp | 当前时间 | String | 是   | "2020-08-14 15:29:29"              |
| sign      | 签名值   | String | 是   | "ff9d58e9abcf50dcc423fad782636c21" |

**私有请求参数：**

| **参数名**    | **含义**     | **类型**   | **必传** | **示例与说明**                           |
| ------------- | ------------ | ---------- | -------- | ---------------------------------------- |
| **sn**        | **序列号**   | **String** | **是**   | **"km789838899"**                        |
| **deviceKey** | **设备密钥** | **String** | **否**   | **如果设备机身贴有密钥，该参数就是必传** |
| **bindName**  | **绑定名称** | **String** | **否**   | **应用方的绑定名称，例如用户名/用户id**  |
| **noteName**  | **备注名称** | **String** | **否**   | **备注名称，例如杭州分店**               |

**入参完整示例：**

```java
{
"sn":"123",
"deviceKey":"123456",
"bindName":"18934769875",
"noteName":"杭州分店",
"appId":"100202",
"timestamp":"2020-08-24 11:11:59",
"sign":"testsignvalue"
}
```

**响应参数：**

| **参数名**  | **含义**     | **类型**    | **说明**                      |
| ----------- | ------------ | ----------- | ----------------------------- |
| **status**  | **响应结果** | **boolean** | **true为成功，false为失败**   |
| **data**    | **响应数据** | **object**  | **具体接口的返回数据**        |
| **message** | **响应说明** | **String**  | **status为false时，返回信息** |
| **code**    | **code码**   | **Number**  | **详情见最下方code码说明**    |

说明：这里的绑定是对接方打印机和云平台之间的绑定，如果绑定成功了，只有该对接方可以调用该打印机打印，如果机器未绑定任何对接方，任何对接方都可以调用该打印机打印.

错误码：

| code | 描述                   | 处理方式                                                                                               |
| ---- | ---------------------- | ------------------------------------------------------------------------------------------------------ |
| 4001 | 该序列号不存在或未激活 | 检查序列号是否和底部或自检页上一致；如果是wifi机型检查是否蓝灯配网是否成功；如果是4G机型检查是否开机； |
| 4009 | 设备密钥不正确         | 设备密钥在机器底部，检查输入是否一致；                                                                 |

#### 2.解绑打印机

**url:**/api/cloud/device/unbindDevice  
**公共请求参数**

| 参数名    | 含义     | 类型   | 必传 | 示例                               |
| --------- | -------- | ------ | ---- | ---------------------------------- |
| appId     | 应用ID   | String | 是   | "1100"                             |
| timestamp | 当前时间 | String | 是   | "2020-08-14 15:29:29"              |
| sign      | 签名值   | String | 是   | "ff9d58e9abcf50dcc423fad782636c21" |

**私有请求参数：**

| **参数名**    | **含义**     | **类型**   | **必传** | **示例与说明**    |
| ------------- | ------------ | ---------- | -------- | ----------------- |
| **sn**        | **序列号**   | **String** | **是**   | **"km789838899"** |
| **deviceKey** | **设备密钥** | **String** | **是**   | **"112233"**      |

**入参完整示例：**

```java
{
"sn":"123",
"deviceKey":"123456",
"appId":"100202",
"timestamp":"2020-08-24 11:11:59",
"sign":"testsignvalue"
}
```

**响应参数：**

| **参数名**  | **含义**     | **类型**    | **说明**                      |
| ----------- | ------------ | ----------- | ----------------------------- |
| **status**  | **响应结果** | **boolean** | **true为成功，false为失败**   |
| **data**    | **响应数据** | **object**  | **具体接口的返回数据**        |
| **message** | **响应说明** | **String**  | **status为false时，返回信息** |
| **code**    | **code码**   | **Number**  | **详情见最下方code码说明**    |

错误码：

| code | 描述                   | 处理方式                                                                                               |
| ---- | ---------------------- | ------------------------------------------------------------------------------------------------------ |
| 4001 | 该序列号不存在或未激活 | 检查序列号是否和底部或自检页上一致；如果是wifi机型检查是否蓝灯配网是否成功；如果是4G机型检查是否开机； |
| 4009 | 设备密钥不正确         | 设备密钥在机器底部，检查输入是否一致；                                                                 |

#### 3.标签模板打印-间隙纸 适用机型:KM118系列,KME31系列,KME41系列，KME20系列，KMSX320,KMUL410

url:/api/cloud/print/tsplTemplatePrint  
**公共请求参数:**

| 参数名    | 含义     | 类型   | 必传 | 示例                               |
| --------- | -------- | ------ | ---- | ---------------------------------- |
| appId     | 应用ID   | String | 是   | "1100"                             |
| timestamp | 当前时间 | String | 是   | "2020-08-14 15:29:29"              |
| sign      | 签名值   | String | 是   | "ff9d58e9abcf50dcc423fad782636c21" |

**私有请求参数：**

| **参数名**          | **含义**                                                | **类型**   | **必传** | **示例与说明**                                                                                                                                                                                                                               |
| ------------------- | ------------------------------------------------------- | ---------- | -------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **sn**              | **序列号**                                              | **String** | **是**   | **"km789838899"**                                                                                                                                                                                                                            |
| **templateId**      | **模版id**                                              | **Number** | **是**   | **1**                                                                                                                                                                                                                                        |
| **renderDataArray** | **模版动态渲染数据(支持一次渲染多份数据,最大支持50份)** | **String** | **是**   | **"\[{ "bindTable1":\[ { "bindkey1":"value1" } \], "bindTable2":\[ { "bindkey1":"value1", "bindkey2":"value2" } \] },{ "bindTable1":\[ { "bindkey1":"value11" } \], "bindTable2":\[ { "bindkey1":"value11", "bindkey2":"value21" } \] }\]"** |
| **printTimes**      | **打印份数**                                            | **Number** | **否**   | **需要打印相同内容的份数**                                                                                                                                                                                                                   |

说明：参数renderDataArray为JSONArray字符串，该JSONArray里的元素类型为JSONObject,JSONObject里的key对应的value值是JSONArray数据结构,具体参考见示例;示例中的bindTable和bindKey对应了字段管理里的表名和字段名;如果有图片传图片的base64数据,图片数据在50KB以内最佳; 单设备打印机接口的QPS最大为6。

[模版打印说明下载链接](https://kuaimai-public.oss-cn-shanghai.aliyuncs.com/public/document/%E5%BF%AB%E9%BA%A6%E4%BA%91%E6%89%93%E5%8D%B0%E6%A8%A1%E7%89%88%E6%89%93%E5%8D%B0%E8%AF%B4%E6%98%8E.docx)

补充说明: renderDataArray渲染多张的用法

如果是渲染一张：\[ {"t":\[ { "bk":"val"} \] }\]

如果是渲染两张：\[ {"t":\[ { "bk":"val"} \] }, { "t":\[ { "bk":"val2"} \] } \]

多张就依此类推了

**入参完整示例**：

```java
{
   "sn":"KM118933",
   "templateId": 11,
   "renderDataArray":"[{\"bindTable1\":[{\"bindkey1\":\"value1\"}],\"bindTable2\":[{\"bindkey1\":\"value1\",\"bindkey2\":\"value2\"}]},{\"bindTable1\":[{\"bindkey1\":\"value11\"}],\"bindTable2\":[{\"bindkey1\":\"value11\",\"bindkey2\":\"value22\"}]}]",
   "appId":"1100",
    "timestamp":"2020-08-24 11:11:59",
    "sign":"testsignvalue"
}
```

**响应参数：**

| **参数名**   | **含义**     | **类型**    | **说明**                      |
| ------------ | ------------ | ----------- | ----------------------------- |
| **status**   | **响应结果** | **boolean** | **true为成功，false为失败**   |
| **data**     | **响应数据** | **object**  | **具体接口的返回数据**        |
| **\-jobIds** |              | **Array**   | **打印任务id**                |
| **message**  | **响应说明** | **String**  | **status为false时，返回信息** |
| **code**     | **code码**   | **Number**  | **详情见最下方code码说明**    |

**出参完整示例：**

```java
{
    "status": true,
    "data": {
        "jobIds": [
        "1612514721477"
        ]
    },
    "message": null,
    "code": null,
    "exceptionMessage": null
}
```

错误码：

| code | 描述                   | 处理方式                                                                                               |
| ---- | ---------------------- | ------------------------------------------------------------------------------------------------------ |
| 4001 | 该序列号不存在或未激活 | 检查序列号是否和底部或自检页上一致；如果是wifi机型检查是否蓝灯配网是否成功；如果是4G机型检查是否开机； |
| 4005 | 设备离线               | 如果是wifi机型检查是否蓝灯配网是否成功；如果是4G机型检查是否开机                                       |
| 6009 | 动态渲染数据结构错误   | 检查renderDataArray参数的数据结构                                                                      |
| 6022 | 动态批量渲染数量过大   | 控制动态批量渲染数量小于等于50                                                                         |
| 6015 | 无权限模版访问         | 检查模版id是否为接口调用appId下新建的                                                                  |
| 6010 | 模版类型不匹配         | 检查模版id是否为标签模版，如果使用了小票模版id会出现该错误                                             |

#### 4.小票模板打印-间隙纸 适用机型:KM118系列,KME31系列,KME41系列，KME20系列，KMSX320,KMUL410

url:/api/cloud/print/tsplTemplateWrite

**公共请求参数:**

| 参数名    | 含义     | 类型   | 必传 | 示例                               |
| --------- | -------- | ------ | ---- | ---------------------------------- |
| appId     | 应用ID   | String | 是   | "1100"                             |
| timestamp | 当前时间 | String | 是   | "2020-08-14 15:29:29"              |
| sign      | 签名值   | String | 是   | "ff9d58e9abcf50dcc423fad782636c21" |

**私有请求参数：**

| **参数名**     | **含义**             | **类型**   | **必传** | **示例与说明**                                                                                                        |
| -------------- | -------------------- | ---------- | -------- | --------------------------------------------------------------------------------------------------------------------- |
| **sn**         | **序列号**           | **String** | **是**   | **"km789838899"**                                                                                                     |
| **templateId** | **模版id**           | **Number** | **是**   | **1**                                                                                                                 |
| **renderData** | **模版动态渲染数据** | **String** | **是**   | **"{ "bindTable1":\[ { "bindkey1":"value1" } \], "bindTable2":\[ { "bindkey1":"value1", "bindkey2":"value2" } \] }"** |
| **printTimes** | **打印份数**         | **Number** | **否**   | **1**                                                                                                                 |

说明：参数renderData为JSONObject字符串，该JSONObject里的key对应的value值是JSONArray数据结构,具体参考见示例;示例中的bindTable和bindKey对应了字段管理里的表名和字段名;如果有图片传图片的base64数据,图片数据在50KB以内最佳,单设备打印机接口的QPS最大为6。  
**入参完整示例**：

```java
{
   "sn":"KM118933",
   "templateId": 11,
   "renderData":"{\"bindTable1\":[{\"bindkey1\":\"value1\"}],\"bindTable2\":[{\"bindkey1\":\"value1\",\"bindkey2\":\"value2\"}]}",
   "appId":"1100",
    "timestamp":"2020-08-24 11:11:59",
    "sign":"testsignvalue"
}
```

**响应参数：**

| **参数名**                | **含义**     | **类型**    | **说明**                      |
| ------------------------- | ------------ | ----------- | ----------------------------- |
| **status**                | **响应结果** | **boolean** | **true为成功，false为失败**   |
| **data**                  | **响应数据** | **object**  | **具体接口的返回数据**        |
| \*\*          -jobIds\*\* |              | **Array**   | **打印任务id**                |
| **message**               | **响应说明** | **String**  | **status为false时，返回信息** |
| **code**                  | **code码**   | **Number**  | **详情见最下方code码说明**    |

**出参完整示例：**

```java
{
    "status": true,
    "data": {
        "jobIds": [
        "1612514721477"
        ]
    },
    "message": null,
    "code": null,
    "exceptionMessage": null
}
```

错误码：

| code | 描述                   | 处理方式                                                                                               |
| ---- | ---------------------- | ------------------------------------------------------------------------------------------------------ |
| 4001 | 该序列号不存在或未激活 | 检查序列号是否和底部或自检页上一致；如果是wifi机型检查是否蓝灯配网是否成功；如果是4G机型检查是否开机； |
| 4005 | 设备离线               | 如果是wifi机型检查是否蓝灯配网是否成功；如果是4G机型检查是否开机                                       |
| 6009 | 动态渲染数据结构错误   | 检查renderDataArray参数的数据结构                                                                      |
| 6022 | 动态批量渲染数量过大   | 控制动态批量渲染数量小于等于50                                                                         |
| 6015 | 无权限模版访问         | 检查模版id是否为接口调用appId下新建的                                                                  |
| 6010 | 模版类型不匹配         | 检查模版id是否为标签模版，如果使用了小票模版id会出现该错误                                             |

#### 5.小票模板打印-连续纸 适用机型:KM118系列,KME31系列,KME41系列，KME20系列，KMDP系列

url:/api/cloud/print/escTemplatePrint

**公共请求参数:**

| 参数名    | 含义     | 类型   | 必传 | 示例                               |
| --------- | -------- | ------ | ---- | ---------------------------------- |
| appId     | 应用ID   | String | 是   | "1100"                             |
| timestamp | 当前时间 | String | 是   | "2020-08-14 15:29:29"              |
| sign      | 签名值   | String | 是   | "ff9d58e9abcf50dcc423fad782636c21" |

**私有请求参数：**

| **参数名**      | **含义**                           | **类型**    | **必传** | **示例与说明**                                                                                                                     |
| --------------- | ---------------------------------- | ----------- | -------- | ---------------------------------------------------------------------------------------------------------------------------------- |
| **sn**          | **序列号**                         | **String**  | **是**   | **"km789838899"**                                                                                                                  |
| **templateId**  | **模版id**                         | **Number**  | **是**   | **1**                                                                                                                              |
| **renderData**  | **模版动态渲染数据**               | **String**  | **是**   | **"{ "bindTable1":\[ { "bindkey1":"value1" } \], "bindTable2":\[ { "bindkey1":"value1", "bindkey2":"value2" } \] }"**              |
| **volume**      | **音量大小（仅支持有语言的机器）** | **Number**  | **否**   | **80（音量大小范围为0～99）**                                                                                                      |
| **volumeIndex** | **语言索引（仅支持有语言的机器）** | **Number**  | **否**   | **2051（**[**索引文件下载**](https://kuaimai-public.oss-cn-shanghai.aliyuncs.com/public/%E7%B4%A2%E5%BC%95%E8%AF%AD%E8%A8%80.xlsx) |
| **）**          |
| **cut**         | **是否切刀(仅支持有切刀的机器）**  | **Boolean** | **否**   | **true**                                                                                                                           |
| **endFeed**     | **末尾走行**                       | **Number**  | **否**   | 9                                                                                                                                  |

说明：参数renderData为JSONObject字符串，该JSONObject里的key对应的value值是JSONArray数据结构,具体参考见示例;示例中的bindTable和bindKey对应了字段管理里的表名和字段名;如果有图片传图片的base64数据,图片数据在50KB以内最佳,单设备打印机接口的QPS最大为6。

[模版打印说明下载链接](https://kuaimai-public.oss-cn-shanghai.aliyuncs.com/public/document/%E5%BF%AB%E9%BA%A6%E4%BA%91%E6%89%93%E5%8D%B0%E6%A8%A1%E7%89%88%E6%89%93%E5%8D%B0%E8%AF%B4%E6%98%8E.docx)

**入参完整示例**：

```java
{
   "sn":"KM118933",
   "templateId": 11,
   "renderData":"{\"bindTable1\":[{\"bindkey1\":\"value1\"}],\"bindTable2\":[{\"bindkey1\":\"value1\",\"bindkey2\":\"value2\"}]}",
   "appId":"1100",
    "timestamp":"2020-08-24 11:11:59",
    "sign":"testsignvalue"
}
```

**响应参数：**

| **参数名**  | **含义**     | **类型**    | **说明**                      |
| ----------- | ------------ | ----------- | ----------------------------- |
| **status**  | **响应结果** | **boolean** | **true为成功，false为失败**   |
| **data**    | **响应数据** | **object**  | **具体接口的返回数据**        |
| **message** | **响应说明** | **String**  | **status为false时，返回信息** |
| **code**    | **code码**   | **Number**  | **详情见最下方code码说明**    |

**出参完整示例：**

```java
{
    "status": true,
    "data": {},
    "message": null,
    "code": null,
    "exceptionMessage": null
}
```

错误码：

| code | 描述                   | 处理方式                                                                                               |
| ---- | ---------------------- | ------------------------------------------------------------------------------------------------------ |
| 4001 | 该序列号不存在或未激活 | 检查序列号是否和底部或自检页上一致；如果是wifi机型检查是否蓝灯配网是否成功；如果是4G机型检查是否开机； |
| 4005 | 设备离线               | 如果是wifi机型检查是否蓝灯配网是否成功；如果是4G机型检查是否开机                                       |
| 6009 | 动态渲染数据结构错误   | 检查renderDataArray参数的数据结构                                                                      |
| 6015 | 无权限模版访问         | 检查模版id是否为接口调用appId下新建的                                                                  |
| 6010 | 模版类型不匹配         | 检查模版id是否为小票模版，如果使用了标签模版id会出现该错误                                             |

#### 6.自定义xml打印-间隙纸 适用机型:KM118系列,KME31系列,KME41系列，KME20系列，KMSX320,KMUL410

**url:**/api/cloud/print/tsplXmlWrite

**公共请求参数:**

| 参数名    | 含义     | 类型   | 必传 | 示例                               |
| --------- | -------- | ------ | ---- | ---------------------------------- |
| appId     | 应用ID   | String | 是   | "1100"                             |
| timestamp | 当前时间 | String | 是   | "2020-08-14 15:29:29"              |
| sign      | 签名值   | String | 是   | "ff9d58e9abcf50dcc423fad782636c21" |

**私有请求参数：**

| **参数名**     | **含义**          | **类型**   | **必传** | **示例与说明**                                                                                                             |
| -------------- | ----------------- | ---------- | -------- | -------------------------------------------------------------------------------------------------------------------------- |
| **sn**         | **序列号**        | **String** | **是**   | **"km789838899"**                                                                                                          |
| **xmlStr**     | **打印xml字符串** | **String** | **是**   | **xml字符串,具体参考指令模版说明**                                                                                         |
| **jobs**       | **批量打印xml**   | **Array**  | **否**   | **xmlStr和jobs传一个即可；jobs这边传的是数组结构；里面的值就是xmlStr组成；最多一次支持20单；KMSX320机型最多一次支持5单；** |
| **printTimes** | **打印份数**      | **Number** | **否**   | **1；若想相同的内容打印2次；即该参数传2**                                                                                  |

**入参完整示例**：

```java
{
    "sn":"KM110h45932",
    "xmlStr":"<page><render><t>hello,word</t></render></page>",
    "appId":"100202",
    "timestamp":"2020-08-24 11:11:59",
    "sign":"testsignvalue"
}
```

**响应参数：**

| **参数名**  | **含义**     | **类型**    | **说明**                      |
| ----------- | ------------ | ----------- | ----------------------------- |
| **status**  | **响应结果** | **boolean** | **true为成功，false为失败**   |
| **data**    | **响应数据** | **object**  | **具体接口的返回数据**        |
| **message** | **响应说明** | **String**  | **status为false时，返回信息** |
| **code**    | **code码**   | **Number**  | **详情见最下方code码说明**    |

**出参完整示例：**

```java
{
    "status": true,
    "data": {},
    "message": null,
    "code": null,
    "exceptionMessage": null
}
```

注：实际打印结果以打印任务结果查询接口为准  
**xmlStr参数指令模版说明：**  
1.指令整体模板

```html
<page>
  <render>
    <t>hello</t>
    <bc x="50" y="50">209490224913</bc>
    <qrc x="100" y="100">529348520501</qrc>
  </render>
</page>
```

2.各指令标签详情  
页元素-page

```html
<page></page> 描述：定义打印纸张
```

根元素-render

```html
<render width="75" height="100"></render> 描述：定义渲染区域 width:
渲染宽度，默认是75（单位毫米） height:
渲染高度，默认是100（单位毫米）,最大支持220mm direction:
出纸方向，可选值是0和180;默认是0
```

打印元素-t

```html
<t x="1" y="1">hello</t>
描述：定义打印文本 x: 起始x坐标，默认是1（单位像素，8像素为1毫米） y:
起始y坐标，默认是1（单位像素，8像素为1毫米） font: 字体名称；默认是TSS16.BF2
TSS16.BF2: TSS 16*16点阵 ，该字体下中文是2mm宽；数字和英文是1mm宽 TSS24.BF2: TSS
24*24点阵 ，该字体下中文是3mm宽；数字和英文是1.5mm宽 textWidth:
文本的展示宽度，单位mm；文本实际内容如果超过该设定值，会自动换行;
换行不会改变下方元素的y坐标的值，如果需要换行
需要在下方留足空白区域；否则会发生打印重叠， bold:
是否加粗,0:不加粗；1:加粗,默认是0 xMultiple: 字体宽的倍数,
默认是1，该参数类型需要为整数 yMultiple:
字体高的倍数，默认是1，该参数类型需要为整数 rotate:
旋转角度，取值：0,90,180,270; 默认是0
```

打印元素-bc

```html
<bc x="1" y="1">209490224913</bc> 描述：定义打印条形码 x:
起始x坐标，距离最左侧的距离，默认是1;单位dot 8dot=1mm y:
起始y坐标，距离最上侧的距离，默认是1;单位dot 8dot=1mm codeType:
条形码样式，默认是128 128: Code 128 bcWidth: 条形码的总宽度，单位mm bcHeight:
条形码的高度，单位mm fontSize: 条形码对应文本的字体大小，单位mm 默认3mm style:
条形码对应文本内容样式,默认是2 0:不显示；2:下方显示 4:上方显示 rotate:
旋转角度，取值：0,90,270; 默认是0
```

打印元素-qrc

```html
<qrc x="1" y="1">529348520501</qrc> 描述：定义打印二维码 x:
起始x坐标，默认是1，单位dot 8dot=1mm y: 起始y坐标，默认是1，单位dot 8dot=1mm
qrcWidth: 二维码宽度和高度，单位mm
```

打印元素-img

```html
<img x='1' y='1' >base64</img>
 图片传图片的base64数据,图片数据在50KB以内最佳
x:
 坐标x
y:
 坐标y
```

打印元素-box

```html
<box x="1" y="1" xEnd="100" yEnd="50" thickness="1" radius="0" /> 描述：定义线框
x: 起始x坐标,默认是1 y: 起始y坐标,默认是1 xEnd: x结束点,默认是100 yEnd:
y结束点,默认是100 thickness: 线条宽度,默认是1 radius: 弧度半径,默认是0
```

打印元素-circle

```html
<circle x="1" y="1" diameter="100" thickness="1" /> 描述：定义圆 x:
起始x坐标,默认是1 y: 起始y坐标,默认是1 thickness: 线条宽度,默认是1 diameter:
直径,默认是100
```

打印元素-ellipse

```html
<ellipse x="1" y="1" width="100" height="50" thickness="1" /> 描述：定义圆 x:
起始x坐标,默认是1 y: 起始y坐标,默认是1 width: 宽度,默认是100 height:
高度,默认是50 thickness: 线条宽度,默认是1
```

打印元素-bar

```html
<bar x="1" y="1" width="100" height="4" /> 描述：定义线条 x: 起始x坐标,默认是1
y: 起始y坐标,默认是1 width: 线条宽度,默认是10 height: 线条高度,默认是10
```

错误码：

| code | 描述                   | 处理方式                                                                                               |
| ---- | ---------------------- | ------------------------------------------------------------------------------------------------------ |
| 4001 | 该序列号不存在或未激活 | 检查序列号是否和底部或自检页上一致；如果是wifi机型检查是否蓝灯配网是否成功；如果是4G机型检查是否开机； |
| 4005 | 设备离线               | 如果是wifi机型检查是否蓝灯配网是否成功；如果是4G机型检查是否开机                                       |
| 6024 | xml数据过大            | 如果是xml数组打印,数组长度控制在小于或等于20                                                           |

#### 7.自定义xml打印-连续纸 适用机型:KM118系列,KME31系列,KME41系列，KME20系列，KMDP系列

**url:**/api/cloud/print/escXmlWrite

**公共请求参数:**

| 参数名    | 含义     | 类型   | 必传 | 示例                               |
| --------- | -------- | ------ | ---- | ---------------------------------- |
| appId     | 应用ID   | String | 是   | "1100"                             |
| timestamp | 当前时间 | String | 是   | "2020-08-14 15:29:29"              |
| sign      | 签名值   | String | 是   | "ff9d58e9abcf50dcc423fad782636c21" |

**私有请求参数：**

| **参数名**       | **含义**                           | **类型**   | **必传** | **示例与说明**                                                                                                                     |
| ---------------- | ---------------------------------- | ---------- | -------- | ---------------------------------------------------------------------------------------------------------------------------------- |
| **sn**           | **序列号**                         | **String** | **是**   | **"km789838899"**                                                                                                                  |
| **instructions** | **打印指令内容**                   | **String** | **是**   | **xml字符串，具体参考指令模版说明**                                                                                                |
| **volume**       | **音量大小（仅支持有语言的机器）** | **Number** | **否**   | **80（音量大小范围为0～99）**                                                                                                      |
| **volumeIndex**  | **语言索引（仅支持有语言的机器）** | **Number** | **否**   | **2051（**[**索引文件下载**](https://kuaimai-public.oss-cn-shanghai.aliyuncs.com/public/%E7%B4%A2%E5%BC%95%E8%AF%AD%E8%A8%80.xlsx) |
| **）**           |
| **cut**          | **是否切刀(仅支持有切刀的机器）**  | **Number** | **否**   | **0**                                                                                                                              |

**入参完整示例：**

```java
{
    "sn":"KM110h45932",
    "instructions":"<page><render><t size='10'>hello,word</t></render></page>",
    "appId":"100202",
    "timestamp":"2020-08-24 11:11:59",
    "sign":"testsignvalue"
}
```

**响应参数：**

| **参数名**  | **含义**     | **类型**    | **说明**                      |
| ----------- | ------------ | ----------- | ----------------------------- |
| **status**  | **响应结果** | **boolean** | **true为成功，false为失败**   |
| **data**    | **响应数据** | **object**  | **具体接口的返回数据**        |
| **message** | **响应说明** | **String**  | **status为false时，返回信息** |
| **code**    | **code码**   | **Number**  | **详情见最下方code码说明**    |

**xmlStr参数指令模版说明：**  
1.指令整体模板

```html
<page>
  <render>
    <t size="10">hello</t>
    <bc model="65" height="80" showT="down" wide="8">209490224913</bc>
    <qrc size="5">529348520501</qrc>
  </render>
</page>
```

2.各指令标签详情  
页元素-page

```html
<page></page> 描述：定义打印纸张
```

根元素-render

```html
<render width="70"></render> 描述：定义渲染区域, width定义打印宽度，单位毫米
```

打印元素-t

```html
<t size="10" align="center" feed="1" x="1">hello</t> 描述：定义打印文本 size：
字体大小，取值： 00-默认 默认情况下中文是3mm，数字英文，标点符号是1.5mm 10-2倍宽
20-3倍宽 11-2倍宽和2倍高... 第一个数字表示宽的倍数，第二个数字表示高的倍数
align: 对齐方式，取值：center-居中，left-左对齐，right-右对齐,默认居中 feed:
回车换行步数，默认是1 bold: 1:文本加粗，0或者不设置为不加粗
```

打印元素-bc

```html
<bc model="73" height="80" showT="down" wide="8" font="0" align="left" feed="1"
  >209490224913</bc
>
描述：定义打印条形码 model：条形码类型，取值0～6，65～73，默认73 0:UPC-A 1:UPC-E
2:JAN13 3:JAN8 4:CODE39 5:ITF 6:CODABAR 65:UPC-A 66:UPC-E 67:JAN13 68:JAN8
69:CODE39 70:ITF 71:CODABAR 72:CODE93 73:CODE128
height：条形码的高度，单位点(dot) 取值：1～255
showT：文字显示，取值down、up、false，非必填属性，默认down
wide：条形码宽条的宽度，单位点(dot)取值：2～6 font: 字体,0-标准,1-压缩 align:
对齐方式，取值：center-居中，left-左对齐，right-右对齐,默认左对齐 feed:
回车换行步数，默认是1
```

打印元素-qrc

```html
<qrc size="5" align="left" feed="1">529348520501</qrc> 描述：定义打印二维码
size：二维码的大小序号，取值0~15，默认3 align:
对齐方式，取值：center-居中，left-左对齐，right-右对齐,默认左对齐 feed:
回车换行步数，默认是1
```

打印元素-img

```html
<img size='0' align='left' feed='1'>base64</img>
描述：定义打印图片,图片传图片的base64数据,图片大小在50KB以内最佳

size：图片的大小，0-正常大小，1-图片宽度扩大，2-图片高度扩大，3-图片宽度和高度同时扩大，默认是0
align:
 对齐方式，取值：center-居中，left-左对齐，right-右对齐,默认左对齐
feed:
 回车换行步数，默认是1
```

开启页模式-pm

```html
<pm width="70" height="30"></pm>
描述：定义页模式的宽度和高度，单位为毫米;
里面可以添加其他的组合元素;组合元素标签需要单独 指定坐标x和y; 坐标单位为毫米。
并排二维码示例：
<pm width="70" height="30">
  <qrc x="1" y="1">123456</qrc>
  <qrc x="20" y="1">789324</qrc>
</pm>
```

错误码：

| code | 描述                   | 处理方式                                                                                               |
| ---- | ---------------------- | ------------------------------------------------------------------------------------------------------ |
| 4001 | 该序列号不存在或未激活 | 检查序列号是否和底部或自检页上一致；如果是wifi机型检查是否蓝灯配网是否成功；如果是4G机型检查是否开机； |
| 4005 | 设备离线               | 如果是wifi机型检查是否蓝灯配网是否成功；如果是4G机型检查是否开机                                       |

#### 8.TSPL/ESC指令打印 适用机型:KM118系列，KME31系列，KME41系列

**url:**/api/cloud/print/deviceWrite

**公共请求参数:**

| 参数名    | 含义     | 类型   | 必传 | 示例                               |
| --------- | -------- | ------ | ---- | ---------------------------------- |
| appId     | 应用ID   | String | 是   | "1100"                             |
| timestamp | 当前时间 | String | 是   | "2020-08-14 15:29:29"              |
| sign      | 签名值   | String | 是   | "ff9d58e9abcf50dcc423fad782636c21" |

**私有请求参数：**

| **参数名**                                          | **含义**                                                         | **类型**   | **必传** | **示例与说明**    |
| --------------------------------------------------- | ---------------------------------------------------------------- | ---------- | -------- | ----------------- |
| **sn**                                              | **序列号**                                                       | **String** | **是**   | **"km789838899"** |
| **instructs**                                       | **打印指令**                                                     | **String** | **是**   | **"**"\*\*        |
| **prereq**                                          | **指令格式，FFFF01:instructs里的指令为base64编码之后的字符串；** |
| **FFFFFF：instructs里的指令为明文指令；默认FFFFFF** | **String**                                                       | **否**     | \*\*\*\* |
| **extra**                                           | **指令类型，0为tspl；2为esc；默认为0**                           | **String** | **否**   | \*\*\*\*          |

**备注:**

[指令说明文档链接，点击前往！](https://www.yuque.com/xiaozhongwang/kb/gg7hgpmf3slhwzv1?singleDoc#)

**入参完整示例：**

```java
{
    "sn":"1609142313064",
    "instructs":"Q0xTDQpTSVpFIDMwbW0sMzBtbQ0KRElSRUNUSU9OIDAsMA0KQk9MRCAwDQpURVhUIDQ3LDI5LCJUU1MyNC5CRjIiLDAsMSwxLCKy4srUtPLToc7Esb4iDQpQUklOVCAxLDENCg==",
    "prereq":"FFFF01",
    "extra":"0",
    "appId":"100202",
    "timestamp":"2020-08-24 11:11:59",
    "sign":"testsignvalue"
}
```

**响应参数：**

| **参数名**                | **含义**     | **类型**    | **说明**                      |
| ------------------------- | ------------ | ----------- | ----------------------------- |
| **status**                | **响应结果** | **boolean** | **true为成功，false为失败**   |
| **data**                  | **响应数据** | **object**  | **具体接口的返回数据**        |
| \*\*          -jobIds\*\* |              | **Array**   | **打印任务id**                |
| **message**               | **响应说明** | **String**  | **status为false时，返回信息** |
| **code**                  | **code码**   | **Number**  | **详情见最下方code码说明**    |

**出参完整示例：**

```java
{
    "status": true,
    "data": {
        "jobIds": [
        "1612514721477"
        ]
    },
    "message": null,
    "code": null,
    "exceptionMessage": null
}
```

注：实际打印结果以打印任务结果查询接口或打印结果推送为准

错误码：

| code | 描述                   | 处理方式                                                                                               |
| ---- | ---------------------- | ------------------------------------------------------------------------------------------------------ |
| 4001 | 该序列号不存在或未激活 | 检查序列号是否和底部或自检页上一致；如果是wifi机型检查是否蓝灯配网是否成功；如果是4G机型检查是否开机； |
| 4005 | 设备离线               | 如果是wifi机型检查是否蓝灯配网是否成功；如果是4G机型检查是否开机                                       |
| 6019 | 打印内容过大           | 减少打印数据的大小,控制在100KB以内                                                                     |

#### 9.ESC指令打印 适用机型:KMDP158,KMDP358,KMDP458,KMUP380C

**url:**/api/cloud/print/escWrite  
**公共请求参数:**

| 参数名    | 含义     | 类型   | 必传 | 示例                               |
| --------- | -------- | ------ | ---- | ---------------------------------- |
| appId     | 应用ID   | String | 是   | "1100"                             |
| timestamp | 当前时间 | String | 是   | "2020-08-14 15:29:29"              |
| sign      | 签名值   | String | 是   | "ff9d58e9abcf50dcc423fad782636c21" |

**私有请求参数：**

| **参数名**           | **含义**                         | **类型**   | **必传** | **示例与说明**              |
| -------------------- | -------------------------------- | ---------- | -------- | --------------------------- |
| **sn**               | **序列号**                       | **String** | **是**   | **"km789838899"**           |
| **instructionsList** | **打印指令内容**                 | **String** | **是**   | **base64编码之后的esc指令** |
| **copies**           | **复制打印次数（最大支持30次）** | **number** | **否**   | 1                           |

**备注:**

[指令说明文档链接，点击前往！](https://www.yuque.com/xiaozhongwang/kb/gg7hgpmf3slhwzv1?singleDoc#)

**入参完整示例:**

```java
{
    "sn":"KM110h45932",
    "instructionsList":"H3MCAAAAAAD/AAAdIQAbYQHJzLzSwaqjqLK5tPKjqQ0KHSERG2EBz7rB+tC3t++6o8/K1uDB+s+6KM3ytO",
    "appId":"100202",
    "timestamp":"2020-08-24 11:11:59",
    "sign":"testsignvalue"
}
```

**响应参数：**

| **参数名**  | **含义**     | **类型**    | **说明**                      |
| ----------- | ------------ | ----------- | ----------------------------- |
| **status**  | **响应结果** | **boolean** | **true为成功，false为失败**   |
| **data**    | **响应数据** | **object**  | **具体接口的返回数据**        |
| **message** | **响应说明** | **String**  | **status为false时，返回信息** |
| **code**    | **code码**   | **Number**  | **详情见最下方code码说明**    |

错误码：

| code | 描述                   | 处理方式                                                                                               |
| ---- | ---------------------- | ------------------------------------------------------------------------------------------------------ |
| 4001 | 该序列号不存在或未激活 | 检查序列号是否和底部或自检页上一致；如果是wifi机型检查是否蓝灯配网是否成功；如果是4G机型检查是否开机； |
| 4005 | 设备离线               | 如果是wifi机型检查是否蓝灯配网是否成功；如果是4G机型检查是否开机                                       |
| 6019 | 打印内容过大           | 减少打印数据的大小,控制在100KB以内；UP系列控制在30KB以内                                               |

#### 10.共享云打印 适用机型:电脑安装番茄打印管家并开通共享打印USB连接的机器

**url:**/api/cloud/print/shareFilePrint

**content-type**: form-data

**公共请求参数:**

| 参数名    | 含义     | 类型   | 必传 | 示例                               |
| --------- | -------- | ------ | ---- | ---------------------------------- |
| appId     | 应用ID   | String | 是   | "1100"                             |
| timestamp | 当前时间 | String | 是   | "2020-08-14 15:29:29"              |
| sign      | 签名值   | String | 是   | "ff9d58e9abcf50dcc423fad782636c21" |

**私有请求参数：**

| **参数名** | **含义**             | **类型**   | **必传** | **示例与说明**                                       |
| ---------- | -------------------- | ---------- | -------- | ---------------------------------------------------- |
| **sn**     | **序列号**           | **String** | **是**   | **"share_789838899"**                                |
| **file**   | **图片打印文件**     | **File**   | **是**   | **png图片文件通过zlib压缩后的数据文件，最大为150KB** |
| **width**  | **打印宽度，单位mm** | **Number** | **是**   | **76**                                               |
| **height** | **打印高度，单位mm** | **Number** | **是**   | **130**                                              |

**入参完整示例：**

```java
{
    "sn":"1609142313064",
    "file":图片压缩文件,
    "width":70,
    "height":130,
    "appId":"100202",
    "timestamp":"2020-08-24 11:11:59",
    "sign":"testsignvalue"
}
```

**响应参数：**

| **参数名**                | **含义**     | **类型**    | **说明**                      |
| ------------------------- | ------------ | ----------- | ----------------------------- |
| **status**                | **响应结果** | **boolean** | **true为成功，false为失败**   |
| **data**                  | **响应数据** | **object**  | **具体接口的返回数据**        |
| \*\*          -jobIds\*\* |              | **Array**   | **打印任务id**                |
| **message**               | **响应说明** | **String**  | **status为false时，返回信息** |
| **code**                  | **code码**   | **Number**  | **详情见最下方code码说明**    |

**出参完整示例：**

```java
{
    "status": true,
    "data": {
        "jobIds": [
        "1612514721477"
        ]
    },
    "message": null,
    "code": null,
    "exceptionMessage": null
}
```

错误码：

| code | 描述                     | 处理方式                                                                                               |
| ---- | ------------------------ | ------------------------------------------------------------------------------------------------------ |
| 4001 | 该序列号不存在或未激活   | 检查序列号是否和底部或自检页上一致；如果是wifi机型检查是否蓝灯配网是否成功；如果是4G机型检查是否开机； |
| 4005 | 设备离线                 | 如果是wifi机型检查是否蓝灯配网是否成功；如果是4G机型检查是否开机                                       |
| 6029 | 文件大小过大             | 控制打印文件在150KB以内                                                                                |
| 6030 | 当前设备不是共享云打印机 | 使用打印管家里的共享云打印序列号打印                                                                   |
| 6032 | 打印量超过了当日打印上限 | 第二天再进行打印，单设备该接口一天最多打印1000次                                                       |
| 6031 | 设备正在打印中           | 稍后再进行调用，设备正在处理打印文件中                                                                 |

#### 11.打印任务结果查询 适用机型:KM118DW,KM118MW,KMSX320,KME20W,KMUL410,KM118DG

打印结果也可以在注册登录的后台配置打印回调地址，这边机器打印成功之后，会把结果推送到该地址（前提是该注册账号绑定了该打印机）

**url:**/api/cloud/print/result

**公共请求参数:**

| 参数名    | 含义     | 类型   | 必传 | 示例                               |
| --------- | -------- | ------ | ---- | ---------------------------------- |
| appId     | 应用ID   | String | 是   | "1100"                             |
| timestamp | 当前时间 | String | 是   | "2020-08-14 15:29:29"              |
| sign      | 签名值   | String | 是   | "ff9d58e9abcf50dcc423fad782636c21" |

**私有请求参数：**

| **参数名**   | **含义**          | **类型**   | **必传** | **示例与说明**        |
| ------------ | ----------------- | ---------- | -------- | --------------------- |
| **sn**       | **序列号**        | **String** | **是**   | **"km789838899"**     |
| **jobIdStr** | **打印任务jobId** | **String** | **是**   | **"\["111","222"\]"** |

说明:jobIdStr参数为数组结构字符串,同一个序列号，一秒钟最多只支持查询两次，单次最大支持50个jobId

**入参完整示例:**

```java
{
    "sn": "KM111112222",
    "jobIdStr": "[\"111\",\"222\"]"
}
```

**响应参数：**

| **参数名**                            | **含义**       | **类型**    | **说明**                                                                                 |
| ------------------------------------- | -------------- | ----------- | ---------------------------------------------------------------------------------------- |
| **status**                            | **响应结果**   | **boolean** | **true为成功，false为失败**                                                              |
| **data**                              | **响应数据**   | **object**  | **具体接口的返回数据**                                                                   |
| **\-jobId**                           | **打印任务id** | **String**  | **打印任务id**                                                                           |
| **\-desc**                            | **结果描述**   | **String**  | **打印结果说明**                                                                         |
| **\-code**                            | **code码**     | **String**  | **code为3000 下发成功；code为2000 打印成功；code为2007 打印失败；code为2004 打印异常；** |
| **code为3001 打印机模式错误打印失败** |
| **message**                           | **响应说明**   | **String**  | **status为false时，返回信息**                                                            |
| **code**                              | **code码**     | **Number**  | **详情见最下方code码说明**                                                               |

**出参完整示例：**

```java
{
    "status": true,
    "data": [
    {
        "code": 2000,
        "desc": "打印成功",
        "jobId": "1612514721477"
    }
    ],
    "message": null,
    "code": null,
    "exceptionMessage": null
}
```

错误码：

| code | 描述                   | 处理方式                                                         |
| ---- | ---------------------- | ---------------------------------------------------------------- |
| 6026 | 打印结果查询超过了限制 | 减少单次查询的jid的数量；控制在小于或等于50                      |
| 6021 | 该序列号查询过于频繁   | 该序列号的任务结果稍后再进行查询；同一个序列号每秒钟最多查询一次 |

#### 12.打印机状态查询

**url:**/api/cloud/device/batchStatus

注: 一次请求最多查询100个设备

**公共请求参数:**

| 参数名    | 含义     | 类型   | 必传 | 示例                               |
| --------- | -------- | ------ | ---- | ---------------------------------- |
| appId     | 应用ID   | String | 是   | "1100"                             |
| timestamp | 当前时间 | String | 是   | "2020-08-14 15:29:29"              |
| sign      | 签名值   | String | 是   | "ff9d58e9abcf50dcc423fad782636c21" |

**私有请求参数：**

| **参数名** | **含义**   | **类型**   | **必传** | **示例与说明**        |
| ---------- | ---------- | ---------- | -------- | --------------------- |
| **snsStr** | **序列号** | **String** | **是**   | **"\["222","444"\]"** |

说明:snsStr参数为数组结构字符串

**入参完整示例：**

```java
{
    "snsStr":"[\"222\",\"444\"]",
    "appId":"100202",
    "timestamp":"2020-08-24 11:11:59",
    "sign":"testsignvalue"
}
```

**响应参数：**

| 参数名         | 含义             | 类型    | 说明                                                       |
| -------------- | ---------------- | ------- | ---------------------------------------------------------- |
| status         | 响应结果         | boolean | true为成功，false为失败                                    |
| data           | 响应数据         | object  |                                                            |
| \-sn           | 序列号           | String  |                                                            |
| \-status       | 打印机在线状态值 | String  | ONLINE:在线; OFFLINE:离线; UNACTIVE:未激活; DISABLE:已禁用 |
| \-deviceStatus | 打印机设备状态   | Number  | 0:正常;1:开盖；2:粘纸；3:缺纸                              |
| message        | 响应说明         | String  | status为false时，返回信息                                  |
| code           | code码           | Number  | 详情见最下方code码说明                                     |

**出参完整示例:**

```java
{
    "status":true,
    "data":[
    {
        "sn":"KM1111",
        "status":"ONLINE",
        "deviceStatus":0
    },
    {
        "sn":"KM2222",
        "status":"ONLINE",
        "deviceStatus":1
    }
    ],
    "message":null,
    "code":null,
    "exceptionMessage":null
}
```

错误码：

| code | 描述                 | 处理方式                                    |
| ---- | -------------------- | ------------------------------------------- |
| 6025 | 查询设备数超过了限制 | 减少单次查询的设备数量；控制在小于或等于100 |

#### 13.语言播报（支持机型:KM118MGL,KME31GP)

**url:**/api/cloud/device/broadcast

**公共请求参数:**

| 参数名    | 含义     | 类型   | 必传 | 示例                               |
| --------- | -------- | ------ | ---- | ---------------------------------- |
| appId     | 应用ID   | String | 是   | "1100"                             |
| timestamp | 当前时间 | String | 是   | "2020-08-14 15:29:29"              |
| sign      | 签名值   | String | 是   | "ff9d58e9abcf50dcc423fad782636c21" |

**私有请求参数：**

| **参数名**        | **含义**     | **类型**   | **必传** | **示例与说明**     |
| ----------------- | ------------ | ---------- | -------- | ------------------ |
| **sn**            | **序列号**   | **String** | **是**   | **"KME31G"**       |
| **volume**        | **音量大小** | **Number** | **是**   | **0～99 例如：80** |
| **volumeContent** | **语言内容** | **String** | **是**   | **"你好来单了"**   |

说明:volumeContent最大支持50个字符

**入参完整示例：**

```java
{
    "sn":"KME31G",
    "appId":"100202",
    "timestamp":"2020-08-24 11:11:59",
    "sign":"testsignvalue",
    "volume":80,
    "volumeContent":"你好来单了"
}
```

**响应参数：**

| 参数名  | 含义     | 类型    | 说明                      |
| ------- | -------- | ------- | ------------------------- |
| status  | 响应结果 | boolean | true为成功，false为失败   |
| data    | 响应数据 | object  |                           |
| message | 响应说明 | String  | status为false时，返回信息 |
| code    | code码   | Number  | 详情见最下方code码说明    |

**出参完整示例:**

```java
{
    "status":true,
    "data":"操作成功",
    "message":null,
    "code":null,
    "exceptionMessage":null
}
```

错误码：

| code | 描述                   | 处理方式                                                         |
| ---- | ---------------------- | ---------------------------------------------------------------- |
| 6036 | 语言播报内容超过了限制 | 减少语言播报的内容长度；控制在小于或等于50个字符                 |
| 6035 | 该机型不支持语言播报   | 使用支持语言播报的机型                                           |
| 4005 | 设备离线               | 如果是wifi机型检查是否蓝灯配网是否成功；如果是4G机型检查是否开机 |

#### 14.取消队列任务

**url:**/api/cloud/print/cancelJob

**公共请求参数:**

| 参数名    | 含义     | 类型   | 必传 | 示例                               |
| --------- | -------- | ------ | ---- | ---------------------------------- |
| appId     | 应用ID   | String | 是   | "1100"                             |
| timestamp | 当前时间 | String | 是   | "2020-08-14 15:29:29"              |
| sign      | 签名值   | String | 是   | "ff9d58e9abcf50dcc423fad782636c21" |

**私有请求参数：**

| **参数名** | **含义**   | **类型**   | **必传** | **示例与说明** |
| ---------- | ---------- | ---------- | -------- | -------------- |
| **sn**     | **序列号** | **String** | **是**   | **"KME31G"**   |

**入参完整示例：**

```java
{
    "sn":"KME31G",
    "appId":"100202",
    "timestamp":"2020-08-24 11:11:59",
    "sign":"testsignvalue"
}
```

**响应参数：**

| 参数名  | 含义     | 类型    | 说明                      |
| ------- | -------- | ------- | ------------------------- |
| status  | 响应结果 | boolean | true为成功，false为失败   |
| data    | 响应数据 | object  |                           |
| message | 响应说明 | String  | status为false时，返回信息 |
| code    | code码   | Number  | 详情见最下方code码说明    |

**出参完整示例:**

```java
{
    "status":true,
    "data":"操作成功",
    "message":null,
    "code":null,
    "exceptionMessage":null
}
```

错误码：

| code | 描述                 | 处理方式                          |
| ---- | -------------------- | --------------------------------- |
| 4012 | 无权限设备，无法清空 | 检查设备是否被你调用的appId所绑定 |

#### 15.调节打印机浓度

**url:**/api/cloud/device/adjustDeviceDensity

适用机型：KM118系列，KME31系列，KME41系列

**公共请求参数:**

| 参数名    | 含义     | 类型   | 必传 | 示例                               |
| --------- | -------- | ------ | ---- | ---------------------------------- |
| appId     | 应用ID   | String | 是   | "1100"                             |
| timestamp | 当前时间 | String | 是   | "2020-08-14 15:29:29"              |
| sign      | 签名值   | String | 是   | "ff9d58e9abcf50dcc423fad782636c21" |

**私有请求参数：**

| **参数名**  | **含义**   | **类型**   | **必传** | **示例与说明**    |
| ----------- | ---------- | ---------- | -------- | ----------------- |
| **sn**      | **序列号** | **String** | **是**   | **"KME31G"**      |
| **density** | **浓度值** | **Number** | **是**   | **浓度值为1～15** |

**入参完整示例：**

```java
{
    "sn":"KME31G",
    "appId":"100202",
    "timestamp":"2020-08-24 11:11:59",
    "density": 8,
    "sign":"testsignvalue"
}
```

**响应参数：**

| 参数名  | 含义     | 类型    | 说明                      |
| ------- | -------- | ------- | ------------------------- |
| status  | 响应结果 | boolean | true为成功，false为失败   |
| data    | 响应数据 | object  |                           |
| message | 响应说明 | String  | status为false时，返回信息 |
| code    | code码   | Number  | 详情见最下方code码说明    |

**出参完整示例:**

```java
{
    "status":true,
    "data":"操作成功",
    "message":null,
    "code":null,
    "exceptionMessage":null
}
```

错误码：

| code | 描述                 | 处理方式 |
| ---- | -------------------- | -------- |
| 6039 | 该机型不支持调节浓度 |          |

其他错误码：

| code码 | 描述                       |
| ------ | -------------------------- |
| 4000   | 序列号为空                 |
| 4015   | 签名错误                   |
| 6006   | 必传参数有为空             |
| 6018   | 图片base64数据错误         |
| 6027   | 打印接口调用过于频繁       |
| 6034   | 文件类型需要为zlib压缩文件 |
